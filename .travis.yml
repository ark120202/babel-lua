git:
  depth: 10
language: node_js
cache: yarn
node_js: 8

before_script:
  - yarn bootstrap
  - yarn build

script:
  - yarn coverage

after_success:
  - yarn coverage-ci

stages:
  - lint
  - flow
  - test
#  - name: publish
#    if: repo = ark120202/babel-lua
#      AND branch = master
#      AND type = push

jobs:
  include:
    - stage: lint
      node_js: 8
      script: yarn lint
    - stage: flow
      node_js: 8
      script: yarn flow
#    - stage: publish
#      node_js: '8'
#      script: 'echo "//registry.npmjs.org/:_authToken=${NPM_TOKEN}" > ~/.npmrc'
#      deploy:
#        provider: script
#        script: npm run publish-master
#        skip_cleanup: true
#        on:
#          condition: '! $TRAVIS_COMMIT_MESSAGE =~ \[skip\ publish\]'
